var game;(function(n){function pt(n){i=document.getElementById(n),r=new createjs.Stage(i),s=new createjs.Text("0","bold 12px Arial","#FFFFFF"),s.textAlign="right",s.x=i.width-10,s.y=22,o=new createjs.Text("Welcome:  Click to play","bold 24px Arial","#FFFFFF"),o.textAlign="center",o.x=i.width/2,o.y=i.height/2,document.onkeydown=ni,document.onkeyup=ti,st()}function st(){r.addChild(o),r.update(),i.onclick=wt}function wt(){i.onclick=null,r.removeChild(o),bt()}function bt(){r.removeAllChildren(),s.text=0..toString(),r.addChild(s),u=[],f=[],e=!0,t=new Ship,t.x=i.width/2,t.y=i.height/2,v=lt,y=0,p=0,h=!1,c=!1,l=!1,a=!1,r.clear(),r.addChild(t),createjs.Ticker.addListener(kt)}function kt(){var s,ut,n,it,nt,rt,ft,tt,et;p<=0?e&&h&&(p=vt,dt()):p--,e&&c?t.rotation-=d:e&&l&&(t.rotation+=d),e&&a?t.accelerate():e&&w&&t.decelerate(),y<=0?e&&(v-=ct,tt=ht(SpaceRock.LRG_ROCK),u[tt].floatOnScreen(i.width,i.height),y=v+v*Math.random()):y--,e&&b(t,t.bounds)&&k(t,t.bounds);for(it in f)(s=f[it],s&&s.active)&&(b(s,t.bounds)&&k(s,t.bounds),s.x+=Math.sin(s.rotation*(Math.PI/-180))*g,s.y+=Math.cos(s.rotation*(Math.PI/-180))*g,--s.entropy<=0&&(r.removeChild(s),s.active=!1));for(ut in u)if(n=u[ut],n&&n.active){if(b(n,n.bounds)&&k(n,n.bounds),n.tick(),e&&n.hitRadius(t.x,t.y,t.hit)){e=!1,r.removeChild(t),o.text="You're dead:  Click to play again",r.addChild(o),st();continue}for(it in f)if((nt=f[it],nt&&nt.active)&&n.hitPoint(nt.x,nt.y)){switch(n.size){case SpaceRock.LRG_ROCK:rt=SpaceRock.MED_ROCK;break;case SpaceRock.MED_ROCK:rt=SpaceRock.SML_ROCK;break;case SpaceRock.SML_ROCK:rt=0}if(e&&ii(n.score),rt>0)for(ft=0;ft<at;ft++)tt=ht(rt),et=Math.random()*n.size*2-n.size,u[tt].x=n.x+et,u[tt].y=n.y+et;r.removeChild(n),u[ut].active=!1,r.removeChild(nt),f[it].active=!1}}t.tick(),r.update()}function b(n,t){return n.x<t*-2||n.y<t*-2||n.x>i.width+t*2||n.y>i.height+t*2}function k(n,t){n.x>i.width+t*2?n.x=t*-2:n.x<t*-2&&(n.x=i.width+t*2),n.y>i.height+t*2?n.y=t*-2:n.y<t*-2&&(n.y=i.height+t*2)}function dt(){var n=f[gt()];n.x=t.x,n.y=t.y,n.rotation=t.rotation,n.entropy=yt,n.active=!0,n.graphics.beginStroke("#FFFFFF").moveTo(-1,0).lineTo(1,0)}function ht(n){for(var t=0,i=u.length;t<=i;)if(u[t])if(u[t].active)t++;else{u[t].activate(n);break}else{u[t]=new SpaceRock(n);break}return i==0&&(u[0]=new SpaceRock(n)),r.addChild(u[t]),t}function gt(){for(var n=0,t=f.length;n<=t;)if(f[n])if(f[n].active)n++;else{f[n].active=!0;break}else{f[n]=new Bullet;break}return t==0&&(f[0]=new Bullet),r.addChild(f[n]),n}function ni(n){if(!n)var n=window.event;switch(n.keyCode){case nt:h=!0;break;case et:case it:c=!0;break;case ot:case rt:l=!0;break;case ft:case tt:a=!0;break;case ut:w=!0}}function ti(n){if(!n)var n=window.event;switch(n.keyCode){case nt:h=!1;break;case et:case it:c=!1;break;case ot:case rt:l=!1;break;case ft:case tt:a=!1;break;case ut:w=!1}}function ii(n){s.text=(Number(s.text)+Number(n)).toString()}var ct=2,lt=110,at=4,vt=5,yt=100,d=7,g=17,nt=32,tt=38,it=37,rt=39,ut=40,ft=87,et=65,ot=68,h,c,l,a,w,v,y,p,u,f,i,r,t,e,o,s;n.init=pt})(game||(game={}))